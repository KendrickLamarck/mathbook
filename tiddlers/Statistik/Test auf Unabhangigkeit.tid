created: 20200622220847032
modified: 20200622225424824
tags: Test
title: Test auf Unabhängigkeit
type: text/vnd.tiddlywiki

Betrachte das statistische Modell $$(E^\N,\mathcal P(E)^{\otimes n},(\prob_\vartheta)_{\vartheta \in \varTheta})$$ mit

* $$E = A \times B,$$ wobei $$A = \{1,\dots,a\},\ B = \{1,\dots,b\}.$$
* $$\varTheta = \{\vartheta = (\vartheta(ij)) \in \openI{0,1}^E : \sum \vartheta(ij) = 1\},$$
* $$\prob_\vartheta(X_k = ij) = \vartheta(ij).$$

Bezeichne mit
$$\vartheta^A = (\vartheta^A(i))_{i \in A},$$ wobei
$$\vartheta^A(i) = \sum_{j \in B} \vartheta(ij)$$
und $$\vartheta^B$$ analog die Randverteilungen. Die Merkmale sind also unabhängig genau dann wenn
$$\vartheta(ij) = \vartheta^A(i)\vartheta^B(j)$$
für alle $$ij \in E.$$

Wir testen die Nullhypothese
$$H_0\colon \vartheta = \vartheta^A \otimes \vartheta^B$$ gegen
$$H_1\colon \vartheta \ne \vartheta^A \otimes \vartheta^B,$$ also
$$\varTheta_0 = \{\alpha \otimes \beta : \alpha \in \varTheta_A,\,\beta \in \varTheta_B\}$$
mit
$$\varTheta_A = \{\alpha \in \openI{0,1}^A : \sum\alpha(i) = 1\}$$
und $$\varTheta_B$$ analog.
Definiere analog zum [[Chiquadrat-Anpassungstest]] die absoluten und relativen Häufigkeiten $$h_n(ij)$$ und $$l_n(ij)$$ sowie die Randverteilungen
$$(l_n^A(i))_{i \in A}$$ mit
$$l_n^A(i) = \sum_{j \in B} l_n(ij)$$
und $$l_n^B,h_n^A,h_n^B$$ analog.

''Ansatz 1.''
Der verallgemeinerte Likelihood-Quotient
$$
R_n = \frac{
  \sup_{\vartheta \in \varTheta_1}
  \prod_{ij \in E} \vartheta(ij)^{h_n(ij)}
}{
  \sup_{\alpha\otimes\beta \in \varTheta_0}
  \prod_{ij \in E} (\alpha(i)\beta(j))^{h_n(ij)}
} 
= \prod_{ij \in E}
  \left(\frac{l_n(ij)}{l_n^A(i)l_n^B(j)}\right)^{h_n(ij)}
$$
also
$$
\log R_n = n\sum_{ij \in E} l_n(ij)\log\frac{l_n(ij)}{l_n^A(i)l_n^B(j)}
$$
und der verallgemeinerte Likelihood-Quotiententest hat die Form $$\varphi_n = \mathbf 1_{\{\log R_n > c\}}.$$

''Ansatz 2.''
Sei
$$\begin{aligned}
D_n &\coloneqq \sum_{ij \in E} \frac{
  (h_n(ij) - h_n^A(i)h_n^B(j)/n)^2
}{
  h_n^A(i)h_n^B(j)/n
} \\ &=
n\sum_{ij \in E} l_n^A(i) l_n^B(j)
\left(\frac{l_n(ij)}{l_n^A(i) l_n^B(j)}-1\right)^2 \\ &=
n\sum_{ij \in E}\frac{l_n(ij)^2}{l_n^A(i)l_n^B(j)} - n
\end{aligned}$$
(die letzte Form eignet sich gut zur Berechnung). Ein Test $$\varphi_n = \mathbf 1_{\{D_n > c\}}$$ heißt dann ein //Chiquadrat-Test auf Unabhängigkeit// nach $$n$$ Beobachtungen.

* Wie beim [[Chiquadrat-Anpassungstest]] stimmen $$D_n$$ und $$R_n$$ auf der Nullhypothese approximativ überein.